#!/bin/bash

# üè• MAHIMA MEDICARE - SIMPLE MANUAL DATABASE MERGE
# =================================================
# The EASIEST way to add your data to production

echo "üè• MAHIMA MEDICARE - SIMPLE DATABASE MERGE GUIDE"
echo "==============================================="
echo ""
echo "üéØ RECOMMENDED APPROACH: ADD YOUR DATA TO PRODUCTION"
echo "===================================================="
echo ""
echo "This is the SAFEST method that preserves all client data!"
echo ""

echo "STEP 1: SSH into your production server"
echo "======================================"
echo "ssh root@139.84.155.25"
echo ""

echo "STEP 2: Navigate and activate environment"
echo "======================================="
echo "cd /var/www/mahima-medicare"
echo "source venv/bin/activate"
echo ""

echo "STEP 3: Create your superuser account"
echo "==================================="
echo "python manage.py createsuperuser"
echo "# Enter your desired username, email, and password"
echo ""

echo "STEP 4: Access admin panel and add your data"
echo "==========================================="
echo "Visit: https://mahimamedicare.co.in/admin/"
echo "Login with the superuser account you just created"
echo ""

echo "STEP 5: Manually add your medicines"
echo "================================="
echo "In admin panel:"
echo "- Go to 'Medicines' section"
echo "- Click 'Add Medicine'"
echo "- Add all 8 medicines from your local database"
echo "- Set prices, descriptions, stock levels"
echo ""

echo "STEP 6: Add admin accounts (if needed)"
echo "===================================="
echo "In admin panel:"
echo "- Go to 'Admin Information' section" 
echo "- Add any additional admin accounts you need"
echo "- Set proper permissions"
echo ""

echo "STEP 7: Add lab technicians (if needed)"
echo "======================================"
echo "In admin panel:"
echo "- Go to 'Clinical Laboratory Technicians'"
echo "- Add required lab staff"
echo ""

echo "STEP 8: Update security fix"
echo "=========================="
echo "Upload your security-fixed files:"
echo "- hospital_admin/urls.py (admin registration disabled)"
echo "- templates/hospital_admin/login.html (registration link removed)"
echo ""
echo "Or apply the fix manually:"
echo "nano hospital_admin/urls.py"
echo "# Comment out the admin_register URL line"
echo ""

echo "STEP 9: Restart services"  
echo "====================="
echo "pkill -f gunicorn"
echo "gunicorn --config gunicorn.conf.py healthstack.wsgi:application &"
echo ""

echo "‚úÖ BENEFITS OF THIS APPROACH:"
echo "============================"
echo "‚úÖ Zero risk of data loss"
echo "‚úÖ Client data remains untouched" 
echo "‚úÖ You add only what you need"
echo "‚úÖ No complex database operations"
echo "‚úÖ Easy to verify each step"
echo ""

echo "üö® WHAT THIS PRESERVES:"
echo "======================"
echo "‚úÖ All existing patient records"
echo "‚úÖ All existing medicine inventory"
echo "‚úÖ All existing lab test data"
echo "‚úÖ All existing doctor profiles"
echo "‚úÖ All existing invoices and payments"
echo ""

echo "üéØ ALTERNATIVE: Export/Import specific items"
echo "==========================================="
echo "If you want to export specific data from local:"
echo ""
echo "# On your local machine:"
echo "python manage.py dumpdata pharmacy.medicine --indent 2 > medicines_only.json"
echo "python manage.py dumpdata hospital_admin.admin_information --indent 2 > admins_only.json"
echo ""
echo "# Upload to production:"
echo "scp medicines_only.json root@139.84.155.25:/var/www/mahima-medicare/"
echo "scp admins_only.json root@139.84.155.25:/var/www/mahima-medicare/"
echo ""
echo "# On production server:"
echo "python manage.py loaddata medicines_only.json"
echo "python manage.py loaddata admins_only.json"
echo ""

echo "üè• This is the SAFEST way to update production!"
echo "Your client's data will be 100% preserved! üõ°Ô∏è"